import{j as e,L as d,h as i,r as m,b as c,f as p,i as F,S as b,k as u}from"./index-fd62c3a0.js";import{u as h}from"./useQuery-e350c3c0.js";import{u as L}from"./index.esm-56edc2c6.js";const w=()=>h({queryKey:["userList"],queryFn:()=>i.get("/employee")}),S=()=>{const{isLoading:t,data:s,isFetched:r,isError:n}=w();return e.jsxs(e.Fragment,{children:[e.jsx("h2",{"data-testid":"employee-list-title",children:"Employee"}),e.jsx("div",{children:t&&"Loading..."}),e.jsx("div",{children:n&&"Failed to fetch"}),e.jsx(d,{to:"/new",children:"Create new employee"}),r&&(s!=null&&s.length)?e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Name"})]})}),e.jsx("tbody",{children:s.map(({id:o,name:a})=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(d,{to:`/${o}`,children:o})}),e.jsx("td",{children:a})]},o))})]}):"No Employee Found"]})},y=({values:t,onUpdate:s,onCreate:r,isSuccess:n})=>{const{register:o,handleSubmit:a,setValue:x,reset:j,formState:{errors:E}}=L({defaultValues:t??{name:""}}),f=async l=>{try{t?await s({id:t.id,...l}):await r(l)}catch(g){console.log(g)}};return m.useEffect(()=>{t!=null&&t.name&&x("name",t.name)},[t]),m.useEffect(()=>{n&&j()},[n]),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:a(f),children:[e.jsx("input",{...o("name",{required:!0}),"data-testid":"input-name"}),E.name&&e.jsx("span",{children:"This field is required"}),e.jsx("input",{type:"submit","data-testid":"button-update"})]})})},q=t=>h({queryKey:["employee",t],queryFn:()=>i.get(`/employee/${t}`)}),C=async t=>{const{id:s,...r}=t;return await i.put(`/employee/${s}`,r)},R=async t=>await i.delete(`/employee/${t}`),$=({id:t})=>{const[,s]=p(),{mutate:r}=c(R,{onSuccess:({message:n})=>{alert(n),s("/")},onError:n=>alert(n)});return e.jsx("button",{onClick:()=>r(t),"data-testid":"button-remove",children:"Remove"})},k=({id:t})=>{const{isLoading:s,data:r,isError:n}=q(t),{mutateAsync:o}=c(C,{onSuccess:({message:a})=>alert(a),onError:a=>alert(a)});return s?e.jsx(e.Fragment,{children:"Loading..."}):n?e.jsx(e.Fragment,{children:"Failed to fetch"}):r?e.jsxs(e.Fragment,{children:[e.jsxs("h3",{style:{display:"flex",justifyContent:"space-between"},"data-testid":"employee-update-title",children:[r.name," ",e.jsx($,{id:t})]}),e.jsx(y,{values:r,onUpdate:o})]}):e.jsx(e.Fragment,{children:"No Employee Found"})},N=async t=>await i.post("/employee",t),Q=()=>{const[,t]=p(),{mutateAsync:s,isSuccess:r}=c(N,{onSuccess:({message:n})=>{alert(n),t("/")},onError:n=>alert(n)});return e.jsxs(e.Fragment,{children:[e.jsx("h3",{"data-testid":"employee-create-title",children:"Create Employee"}),e.jsx(y,{onCreate:s,isSuccess:r})]})},U=()=>e.jsxs(F,{base:"/ml-frontend/employees",children:[e.jsx(S,{}),e.jsxs(b,{children:[e.jsx(u,{path:"/new",children:e.jsx(Q,{})}),e.jsx(u,{path:"/:id",children:({id:t})=>t?e.jsx(k,{id:t}):null})]})]});export{U as default};
